CREATE DATABASE MYBUS;

USE MYBUS;

CREATE TABLE BusInfo
(
Bus_ID INTEGER NOT NULL PRIMARY KEY,
BoardingPoint VARCHAR(30) NOT NULL,
TravelDate DATETIME NOT NULL,
Amount DECIMAL NOT NULL,
Rating INTEGER
);

CREATE PROCEDURE MYBUS(@Bus_ID int,
                               @BoardingPoint nchar(30),
							   @TravelDate DATETIME,
							   @Amount DECIMAL,
							   @Rating INT)
							   AS
							   BEGIN 
							   INSERT INTO BusInfo
							   (Bus_ID,BoardingPoint,TravelDate,Amount,Rating)
							   VALUES (@Bus_ID,
                               @BoardingPoint ,
							   @TravelDate ,
							   @Amount ,
							   @Rating)
							   END

USE [MYBUS]
GO

DECLARE	@return_value int

EXEC	@return_value = [dbo].[MYBUS]
		@Bus_ID = 1,
		@BoardingPoint = N'BGL',
		@TravelDate = N'2017-06-18',
		@Amount = 400.65,
		@Rating = 2

SELECT	'Return Value' = @return_value

GO
USE [MYBUS]
GO

DECLARE	@return_value int

EXEC	@return_value = [dbo].[MYBUS]
		@Bus_ID = 2,
		@BoardingPoint = N'HYD',
		@TravelDate = N'2017-10-05',
		@Amount = 600.00,
		@Rating = 3

SELECT	'Return Value' = @return_value

GO
USE [MYBUS]
GO

DECLARE	@return_value int

EXEC	@return_value = [dbo].[MYBUS]
		@Bus_ID = 3,
		@BoardingPoint = N'CHN',
		@TravelDate = N'2016-07-25',
		@Amount = 445.95,
		@Rating = 3

SELECT	'Return Value' = @return_value

GO
USE [MYBUS]
GO

DECLARE	@return_value int

EXEC	@return_value = [dbo].[MYBUS]
		@Bus_ID = 4,
		@BoardingPoint = N'PUN',
		@TravelDate = N'2017-12-10',
		@Amount = 543.00,
		@Rating = 4

SELECT	'Return Value' = @return_value

GO
USE [MYBUS]
GO

DECLARE	@return_value int

EXEC	@return_value = [dbo].[MYBUS]
		@Bus_ID = 5,
		@BoardingPoint = N'MUM',
		@TravelDate = N'2017-01-28',
		@Amount = 500.50,
		@Rating = 4

SELECT	'Return Value' = @return_value

GO
USE [MYBUS]
GO

DECLARE	@return_value int

EXEC	@return_value = [dbo].[MYBUS]
		@Bus_ID = 6,
		@BoardingPoint = N'PUN',
		@TravelDate = N'2016-03-27',
		@Amount = 333.55,
		@Rating = 3

SELECT	'Return Value' = @return_value

GO
USE [MYBUS]
GO

DECLARE	@return_value int

EXEC	@return_value = [dbo].[MYBUS]
		@Bus_ID = 7,
		@BoardingPoint = N'MUM',
		@TravelDate = N'2016-11-06',
		@Amount = 510.00,
		@Rating = 4

SELECT	'Return Value' = @return_value

GO
SELECT BoardingPoint,TravelDate
FROM BusInfo
WHERE Amount > 450;


CREATE VIEW Bus_View
AS 
SELECT Bus_ID,BoardingPoint
FROM BusInfo
WHERE Rating>3;

SELECT * FROM Bus_View; --To execute a View

select * from BusInfo;





create table FootBallLeague
(MatchID INTEGER NOT NULL PRIMARY KEY,
TeamName1 VARCHAR(100),
TeamName2 VARCHAR(100),
Status varchar(40),
WinningTeam varchar(50),
Points integer);

select * from FootBallLeague;

CREATE PROCEDURE sample2 (@MatchId int,
                               @TeamName1 nchar(20),
							   @TeamNmae2 nchar(20),
							   @Status nchar(20),
							   @WinningTeam nchar(20),
							   @Points int)
							   AS
							   BEGIN 
							   INSERT INTO FootBallLeague
							   (MatchID,TeamName1,TeamName2,Status,WinningTeam,Points)
							   VALUES (@MatchId,
                               @TeamName1 ,
							   @TeamNmae2 ,
							   @status ,
							   @Winningteam ,
							   @Points)
							   END

							   USE [sample3]
GO

DECLARE	@return_value int

EXEC	@return_value = [dbo].[sample2]
		@MatchId = 1001,
		@TeamName1 = N'Italy',
		@TeamNmae2 = N'France',
		@Status = N'Win',
		@WinningTeam = N'France',
		@Points = 4

SELECT	'Return Value' = @return_value

GO
USE [sample3]
GO

DECLARE	@return_value int

EXEC	@return_value = [dbo].[sample2]
		@MatchId = 1003,
		@TeamName1 = N'England',
		@TeamNmae2 = N'Japan',
		@Status = N'Win',
		@WinningTeam = N'England',
		@Points = 4

SELECT	'Return Value' = @return_value

GO
USE [sample3]
GO

DECLARE	@return_value int

EXEC	@return_value = [dbo].[sample2]
		@MatchId = 1004,
		@TeamName1 = N'USA',
		@TeamNmae2 = N'Russia',
		@Status = N'Win',
		@WinningTeam = N'Russia',
		@Points = 4

SELECT	'Return Value' = @return_value

GO
USE [sample3]
GO

DECLARE	@return_value int

EXEC	@return_value = [dbo].[sample2]
		@MatchId = 1005,
		@TeamName1 = N'Portugal',
		@TeamNmae2 = N'Italy',
		@Status = N'Draw',
		@WinningTeam = NULL,
		@Points = 2

SELECT	'Return Value' = @return_value

GO
USE [sample3]
GO

DECLARE	@return_value int

EXEC	@return_value = [dbo].[sample2]
		@MatchId = 1006,
		@TeamName1 = N'Brazil',
		@TeamNmae2 = N'France',
		@Status = N'Win',
		@WinningTeam = N'Brazil',
		@Points = 4

SELECT	'Return Value' = @return_value

GO
USE [sample3]
GO

DECLARE	@return_value int

EXEC	@return_value = [dbo].[sample2]
		@MatchId = 1007,
		@TeamName1 = N'England',
		@TeamNmae2 = N'Russia',
		@Status = N'Win',
		@WinningTeam = N'Russia',
		@Points = 4

SELECT	'Return Value' = @return_value

GO
USE [sample3]
GO

DECLARE	@return_value int

EXEC	@return_value = [dbo].[sample2]
		@MatchId = 1008,
		@TeamName1 = N'Japan',
		@TeamNmae2 = N'USA',
		@Status = N'Draw',
		@WinningTeam = NULL,
		@Points = 2

SELECT	'Return Value' = @return_value

GO

/* Retrieve all the winning TeamNames */ 

select TeamName1,TeamName2 
from FootBallLeague
where Status='Win';

/*	Create View Match_View to display the teams whose status is Draw   */

CREATE VIEW MatchView  AS
SELECT TeamName1,TeamName2
FROM FootBallLeague
WHERE Status='Draw';

select * from [MatchView];  /* Display View */

/* Retrieve the details of all matches in which Japan played */

select * from FootBallLeague
where TeamName1='Japan' or TeamName2='Japan';
